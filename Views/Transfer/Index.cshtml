@model IEnumerable<Concept.Models.StoreTransferHeader>





@{


    ViewData["Title"] = "Store Transfers";


    var filter = ViewBag.Filter ?? "all";


}





<div class="container-fluid">


    <div class="row mb-3">


        <div class="col-md-6">


            <h2>Store Transfers</h2>


        </div>


        <div class="col-md-6 text-end">


            <a asp-action="Create" class="btn btn-primary">


                <i class="bi bi-plus-circle"></i> New Transfer


            </a>


        </div>


    </div>





    @if (TempData["SuccessMessage"] != null)


    {


        <div class="alert alert-success alert-dismissible fade show" role="alert">


            @TempData["SuccessMessage"]


            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>


        </div>


    }





    @if (TempData["ErrorMessage"] != null)


    {


        <div class="alert alert-danger alert-dismissible fade show" role="alert">


            @TempData["ErrorMessage"]


            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>


        </div>


    }





    <!-- Filter Tabs -->


    <ul class="nav nav-tabs mb-3">


        <li class="nav-item">


            <a class="nav-link @(filter == "all" ? "active" : "")" asp-action="Index" asp-route-filter="all">


                All <span class="badge bg-secondary">@ViewBag.AllCount</span>


            </a>


        </li>


        <li class="nav-item">


            <a class="nav-link @(filter == "pending" ? "active" : "")" asp-action="Index" asp-route-filter="pending">


                Pending <span class="badge bg-warning text-dark">@ViewBag.PendingCount</span>


            </a>


        </li>


        <li class="nav-item">


            <a class="nav-link @(filter == "approved" ? "active" : "")" asp-action="Index" asp-route-filter="approved">


                Approved <span class="badge bg-success">@ViewBag.ApprovedCount</span>


            </a>


        </li>


        <li class="nav-item">


            <a class="nav-link @(filter == "rejected" ? "active" : "")" asp-action="Index" asp-route-filter="rejected">


                Rejected <span class="badge bg-danger">@ViewBag.RejectedCount</span>


            </a>


        </li>


    </ul>





    <div class="card">


        <div class="card-body">


            <div class="table-responsive">


                <table class="table table-striped table-hover">


                    <thead>


                        <tr>


                            <th>Transfer No</th>


                            <th>Transfer Code</th>


                            <th>Transfer Type</th>


                            <th>Date</th>


                            <th>From</th>


                            <th>To</th>


                            <th>Status</th>


                            <th>User</th>


                            <th>Actions</th>


                        </tr>


                    </thead>


                    <tbody>


                        @if (Model.Any())


                        {


                            @foreach (var item in Model)


                            {


                                <tr>


                                    <td>@item.TransferNo</td>


                                    <td>@item.TransferCode</td>


                                    <td>


                                        @switch (item.TransferType)


                                        {


                                            case 1:


                                                <span class="badge bg-info">Warehouse to Warehouse</span>


                                                break;


                                            case 2:


                                                <span class="badge bg-primary">Warehouse to Department</span>


                                                break;


                                            case 3:


                                                <span class="badge bg-warning text-dark">Department to Warehouse</span>


                                                break;


                                            case 4:


                                                <span class="badge bg-secondary">Department to Department</span>


                                                break;


                                            default:


                                                <span class="badge bg-light text-dark">Unknown</span>


                                                break;


                                        }


                                    </td>


                                    <td>@item.TransferDate.ToString("dd/MM/yyyy")</td>


                                    <td>


                                        @if (item.TransferType == 1 || item.TransferType == 2)


                                        {


                                            @(item.FromWarehouse?.WarehouseName ?? "N/A")


                                        }


                                        else


                                        {


                                            @(item.FromDepartment?.DepartmentName ?? "N/A")


                                        }


                                    </td>


                                    <td>


                                        @if (item.TransferType == 1 || item.TransferType == 3)


                                        {


                                            @(item.ToWarehouse?.WarehouseName ?? "N/A")


                                        }


                                        else


                                        {


                                            @(item.ToDepartment?.DepartmentName ?? "N/A")


                                        }


                                    </td>


                                    <td>


                                        @switch (item.TransferStatus)


                                        {


                                            case 0:


                                                <span class="badge bg-warning text-dark">Pending</span>


                                                break;


                                            case 1:


                                                <span class="badge bg-success">Approved</span>


                                                break;


                                            case 2:


                                                <span class="badge bg-danger">Rejected</span>


                                                break;


                                            default:


                                                <span class="badge bg-secondary">Unknown</span>


                                                break;


                                        }


                                    </td>


                                    <td>@(item.User?.FullName ?? "N/A")</td>


                                    <td>


                                        <div class="btn-group" role="group">


                                            <a asp-action="Details" asp-route-id="@item.Id" class="btn btn-sm btn-info" title="Details">


                                                <i class="bi bi-eye"></i>


                                            </a>


                                            @if (item.TransferStatus == 0)


                                            {


                                                <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-sm btn-warning" title="Edit">


                                                    <i class="bi bi-pencil"></i>


                                                </a>


                                            }


                                            @if (item.TransferStatus != 1)


                                            {


                                                <form asp-action="Delete" asp-route-id="@item.Id" method="post" class="d-inline" onsubmit="return confirm('Are you sure you want to delete this transfer?');">


                                                    @Html.AntiForgeryToken()


                                                    <button type="submit" class="btn btn-sm btn-danger" title="Delete">


                                                        <i class="bi bi-trash"></i>


                                                    </button>


                                                </form>


                                            }


                                        </div>


                                    </td>


                                </tr>


                            }


                        }


                        else


                        {


                            <tr>


                                <td colspan="9" class="text-center">No transfers found</td>


                            </tr>


                        }


                    </tbody>


                </table>


            </div>


        </div>


    </div>


</div>





@section Scripts {


    <script>


        // Auto-hide alerts after 5 seconds


        setTimeout(function () {


            $('.alert').fadeOut('slow');


        }, 5000);


    </script>


}